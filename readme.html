<style>
* {margin: 0; padding: 0}
body {line-height: 1.4em; background-color: #F8F8F8; padding: .7em}
p {margin: 1em 0; line-height: 1.5em}
table {font-size: inherit; font: 100%; margin: 1em}
table th {border-bottom: 1px solid #bbb; padding: .2em 1em}
table td {border-bottom: 1px solid #ddd; padding: .2em 1em}
pre,code {font-family: monospace}
pre {margin: 1em 0; background-color: #eee; border: 1px solid #ddd; padding: 5px; line-height: 1.5em; color: #444; overflow: auto; box-shadow: rgba(0,0,0,.07) 0 1px 2px inset; border-radius: 3px; border-radius: 3px; border-radius: 3px}
pre code {padding: 0; background-color: #eee; border: none}
code {background-color: #f8f8ff; color: #444; padding: 0 .2em; border: 1px solid #dedede}
img {border: 0; margin: 1em 0; max-width: 100%}
h2,h3 {margin: 1em 0}
h1,h2,h3,h4,h5,h6 {border: 0}
h1 {font-size: 150%; border-top: 4px solid #299; padding-top: .5em; margin-top: 1.5em}
h1: first-child {margin-top: 0; padding-top: .25em; border-top: none}
h2 {font-size: 120%; margin-top: 1.5em; border-bottom: 1px solid #ddd; padding-bottom: .5em}
h3 {margin-top: 1em}
hr {height: 0; margin: 15px 0; overflow: hidden; background: transparent; border: 0; border-bottom: 4px solid #ddd}
ul {margin: 1em 0 1em 2em}
ol {margin: 1em 0 1em 2em}
ul li,ol li {margin-top: .5em; margin-bottom: .5em}
ul ul,ul ol,ol ol,ol ul {margin-top: 0; margin-bottom: 0}
blockquote {margin: 1em 0; border-left: 5px solid #ddd; padding-left: .6em; color: #555}
dt {font-weight: 700; margin-left: 1em}
dd {margin-left: 2em; margin-bottom: 1em}
</style>

<h1 id="秀丸アップデーター-v11">秀丸アップデーター v1.1</h1>
<ul>
<li>作者: suzu</li>
</ul>
<h1 id="概要">概要</h1>
<ul>
<li>秀丸シリーズのソフトウェアのバージョン管理ツールです。<ul>
<li>秀丸シリーズは更新頻度も高くエディションもアドインもいろいろあり、ソフトウェアとしては素晴らしい状況といえます。</li>
<li>一方で、ユーザーにとってバージョン管理が面倒という側面もあります。</li>
<li>「秀丸アップデーター」はその面倒を低減させるためのツールです。</li>
<li>秀丸エディタなどの各種ソフトウェアについて、公開バージョンの確認とインストーラーのダウンロード・実行をまとめて行います。</li>
</ul>
</li>
<li>多くのWindows環境で、そのまま実行できます。<ul>
<li>WSH上で動くJScriptファイルです。（新機能）</li>
<li>新品のPCに一発で、望みの秀丸シリーズ全部をインストールできます。</li>
</ul>
</li>
<li>INIファイルの編集によって各種の設定を行います。<ul>
<li>初期値で、以下の9種のソフトの「通常の最新版」のインストール・更新に対応しています。<ul>
<li>秀丸エディタ</li>
<li>秀丸パブリッシャー</li>
<li>秀丸ファイラー</li>
<li>秀丸メール</li>
<li>HTMLメールViewer</li>
<li>アドレス帳シンクロナイザ</li>
<li>簡単ネット検索アドイン</li>
<li>秀丸スタートメニュー</li>
<li>パスワード総合管理</li>
</ul>
</li>
<li>ソフトウェア毎、あるいはまとめて、「開発版」「最新版」などの指定ができます。</li>
<li>64bit版、音声化版などの各種エディションの指定も可能です。</li>
<li>共通のINIファイルで、PCごとにインストールするソフトの種類、バージョンやエディションの個別指定もできます。</li>
</ul>
</li>
</ul>
<h1 id="実行方法">実行方法</h1>
<ul>
<li>付属の <em>hideup.js</em> を実行します。<ul>
<li>コマンドプロンプト（デフォルトターミナル）上で、スクリプトが起動される</li>
<li>インストールすべきソフトとバージョンが調査され、確認メッセージが表示される<ul>
<li>よければ"y"と返答すると、ダウンロード・インストールが実行される</li>
<li>変更したい点があれば中断し、INIファイルを編集し再実行</li>
</ul>
</li>
</ul>
</li>
</ul>
<h1 id="動作原理">動作原理</h1>
<h2 id="動作">動作</h2>
<ol>
<li>秀丸シリーズのウェブサイトから各ページを読み込む</li>
<li>公開されているバージョン番号を収集</li>
<li>「インストールされている」バージョンと照らしあわせ、更新があるか判断する<ul>
<li>詳細は後述</li>
</ul>
</li>
<li>更新があればソフト名とバージョンを表示し、作業を実行するかユーザーに質問<ul>
<li>設定により、ソフトウェアの「改版履歴」ページを開く</li>
<li>ここで停止できるので、まずは確認してみてからの実行が可能</li>
</ul>
</li>
<li>必要に応じて「インストーラー置き場フォルダ」にインストーラーをダウンロード<ul>
<li>古いバージョンのインストーラーファイルがあれば削除</li>
</ul>
</li>
<li>インストーラーを実行</li>
<li>設定に従ってソフトウェアを自動起動</li>
</ol>
<h2 id="ターミナル上での動作について">ターミナル上での動作について</h2>
<ul>
<li>このスクリプトは、CUIでの動作を前提にしています。<ul>
<li>wscript.exeで起動された場合（通常はそうなる）、cscript.exeで再起動する仕組み</li>
</ul>
</li>
<li>まれにコンソール上での表示がうまくいかない場合があります。<ul>
<li>ターミナル上で、<code>cscript.exe .\hideup.js</code>のようなコマンドで実行すれば確実</li>
</ul>
</li>
</ul>
<h2 id="「インストールされている」の判断について">「インストールされている」の判断について</h2>
<ul>
<li><strong>インストールされている</strong>バージョンの確認法は2種類<ul>
<li>レジストリモード</li>
<li>インストーラーファイルモード</li>
</ul>
</li>
<li>レジストリモード（新機能）<ul>
<li>レジストリから、インストールされているバージョンを取得し、公開バージョンと比較する</li>
<li>INIファイル（後述）で、キー <em>regist</em> の値が設定されているソフトウェアはレジストリモードになる</li>
<li>「HTMLメールViewer」など、いくつかのソフトウェアで非対応</li>
<li>複数のエディション（例: 32ビット版と64ビット版の両方）をインストールしているような状況や、別のエディションに切り替えるときなど、対応できない状況がある</li>
</ul>
</li>
<li>インストーラーファイルモード<ul>
<li>「インストーラー置き場フォルダ」にそのバージョンのインストーラーファイルがあれば、<strong>インストールされている</strong>、なければ<strong>インストールされていない</strong>という判断</li>
<li>「インストーラー置き場フォルダ」は、C:\Users\ユーザー名\AppData\Roaming\hidemaru_updater</li>
<li>実際にインストールされているバージョンを調べるわけではない</li>
<li>したがって、次のような問題がある<ul>
<li>初回起動時は何もインストールされていないものとして動作する</li>
<li>インストールのキャンセルやエラーは検知しない</li>
<li>浮動小数点版などの別エディションへの変更後は、以前のインストーラーが削除されず、したがって追従できない</li>
</ul>
</li>
<li>その反面、シンプルな挙動なので対応は容易<ul>
<li>ファイルの有無で状況を確認できる</li>
<li>矛盾の解消は、ファイルの削除や、インストーラー実行時のキャンセルなど、単純な方法で可能</li>
</ul>
</li>
</ul>
</li>
</ul>
<h1 id="設定方法">設定方法</h1>
<ul>
<li>設定は、INIファイル( <em>hideup.ini</em> )の編集で行います。</li>
<li>簡単に設定変更できるように、INIファイル自体にもコメントで解説が入れてあります。</li>
</ul>
<h2 id="セクション-all">セクション <em>[all]</em></h2>
<ul>
<li><em>num_ver</em><ul>
<li>インストールするバージョンのデフォルト値を指定</li>
</ul>
</li>
</ul>
<table>
<thead>
<tr>
<th align="left">値</th>
<th align="left">意味</th>
</tr>
</thead>
<tbody><tr>
<td align="left">1</td>
<td align="left">先行開発版（ベータ版)、なければ通常の最新版</td>
</tr>
<tr>
<td align="left">2</td>
<td align="left">通常の最新版</td>
</tr>
<tr>
<td align="left">3</td>
<td align="left">一つ前の版、なければ通常の最新版</td>
</tr>
</tbody></table>
<ul>
<li><em>no_ask</em><ul>
<li>これを<em>1</em>にすると、確認無しでダウンロード・インストール作業が開始される</li>
<li>デフォルトは<em>0</em>、確認の質問が出る状態になっている</li>
</ul>
</li>
<li><em>open_hist</em> （新機能）<ul>
<li>これを<em>1</em>にすると、更新のあるソフトウェアの改版履歴（リリースノート）ページが自動で開かれる</li>
<li>無効にすると、コンソール上にURLが表示される<ul>
<li>URLリンクに対応しているターミナルなら、手動で開ける</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="その他のセクション">その他のセクション</h2>
<ul>
<li>セクション名<ul>
<li>ソフトウェア名</li>
<li>単に表示に使うだけなので、見分けやすい名称にすればよい</li>
<li>32ビット版と64ビット版の両方入れる場合など、別セクションに分けることも可能</li>
<li>以下のいずれかで、そのソフトウェアを無効にできる<ul>
<li>後述の <em>ignore</em> を使う</li>
<li>セクション全行をコメントアウト（先頭の文字を;（セミコロン） にする）</li>
<li>セクション全行を削除</li>
</ul>
</li>
</ul>
</li>
<li><em>url</em><ul>
<li>ソフトの個別ページのアドレスの末尾（最後のスラッシュ以降）の部分</li>
</ul>
</li>
<li><em>file</em><ul>
<li>インストーラーファイルのバージョン番号を"<em>&lt;ver&gt;</em>"に変更したもの</li>
<li>32/64bit版、浮動小数点版などの種類を、この値によって指定する</li>
</ul>
</li>
<li><em>ignore</em><ul>
<li>これを1にすると、そのソフトについてはなにも実行されない</li>
</ul>
</li>
<li><em>num_ver</em><ul>
<li>インストールするバージョン</li>
<li>セクション <em>[all]</em> の <em>num_ver</em> と同様だが、こちらが優先される</li>
<li>ソフト個別に指定する場合はこの値を指定する</li>
</ul>
</li>
<li><em>regist</em><ul>
<li>バージョン番号を読み取るレジストリ名</li>
<li>このキーからバージョン番号を読み取る（???の部分を書き込む）</li>
<li><code>HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\???\DisplayVersion</code></li>
</ul>
</li>
<li><em>autorun</em><ul>
<li>これを1にすると、インストール作業後に動作していないソフトウェアを自動起動する</li>
<li><em>regist</em> が設定されているソフトウェアのみ</li>
</ul>
</li>
</ul>
<h2 id="pcごとの設定">PCごとの設定</h2>
<ul>
<li>上述のキー名の後に"_"（アンダーバー）とPC名を追加すると、そのPCのみの設定となる<ul>
<li>例: <code>num_ver_pc1 = 1</code> とすると、「pc1」というPCではベータ版優先のインストールとなる</li>
<li>共通のINIファイルで、特定のPCは「秀丸メールをインストールしない」とか、「32bit版を入れる」とか、そういった指定が可能</li>
<li>OneDriveなどのクラウドストレージ上に置くことを想定</li>
</ul>
</li>
</ul>
<h1 id="更新">更新</h1>
<ul>
<li>v1.1<ul>
<li>レジストリから秀丸メールのバージョン番号を正しく読み取れなかったバグを修正</li>
<li>ベータ版が複数公開されていると、バージョンがずれるバグを修正</li>
</ul>
</li>
<li>v1<ul>
<li>言語をPHPからWSH JScriptに変更</li>
<li>レジストリからのバージョン番号読み込み</li>
<li>改版履歴ページ（リリースノート）ページを開く機能</li>
<li>インストール終了後のソフトウェアの自動起動</li>
</ul>
</li>
<li>バージョンなし<ul>
<li>公開</li>
</ul>
</li>
</ul>
<h1 id="使用について">使用について</h1>
<ul>
<li>複製、改造、再配布に制限はありません。</li>
<li>無保証です。</li>
</ul>
